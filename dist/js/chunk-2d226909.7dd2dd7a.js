(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d226909"],{e8cc:function(e,a,t){"use strict";t.r(a);var l=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("v-card",{attrs:{rounded:"0"}},[t("v-data-table",{staticClass:"elevation-1 rounded-t",attrs:{headers:e.headers,items:e.alugueis,"items-per-page":e.pageSize,search:e.search,"hide-default-footer":"",loading:e.loading},scopedSlots:e._u([{key:"top",fn:function(){return[t("v-toolbar",{staticClass:"blue-grey darken-3 rounded-t",attrs:{flat:""}},[t("v-toolbar-title",{staticClass:"white--text"},[e._v("Alugueis")]),t("v-divider",{staticClass:"mx-4 white",attrs:{inset:"",vertical:""}}),t("v-text-field",{staticClass:"white--text",attrs:{"append-icon":"mdi-magnify",label:"Procurar...","single-line":"","hide-details":"",color:"white",dark:""},model:{value:e.search,callback:function(a){e.search=a},expression:"search"}}),t("v-spacer"),t("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:e._u([{key:"activator",fn:function(a){var l=a.on,o=a.attrs;return[t("v-btn",e._g(e._b({staticClass:"mb-2",attrs:{color:"blue-grey",dark:""}},"v-btn",o,!1),l),[e._v(" Novo Aluguel ")])]}}]),model:{value:e.dialog,callback:function(a){e.dialog=a},expression:"dialog"}},[t("v-card",[t("v-card-title",{staticClass:"blue-grey darken-3"},[t("span",{staticClass:"text-h5 white--text"},[e._v(e._s(e.formTitle))])]),t("v-card-text",[t("v-form",{ref:"form"},[t("v-container",[t("v-row",[t("v-col",{attrs:{cols:"12"}},[t("v-select",{attrs:{items:e.livros,"item-text":"nome","item-value":"id",label:"Escolha um livro",color:"blue-grey","item-color":"blue-grey","no-data-text":"Sem livros no estoque",rules:[e.rules.required],outlined:""},scopedSlots:e._u([{key:"selection",fn:function(a){return[e._v(" "+e._s(a.item.id)+" - "+e._s(a.item.nome)+" ")]}},{key:"item",fn:function(a){return[e._v(" "+e._s(a.item.id)+" - "+e._s(a.item.nome)+" ")]}}]),model:{value:e.aluguel.livroId,callback:function(a){e.$set(e.aluguel,"livroId",a)},expression:"aluguel.livroId"}})],1)],1),t("v-row",[t("v-col",{attrs:{cols:"12"}},[t("v-select",{attrs:{items:e.usuarios,"item-text":"nome","item-value":"id",label:"Escolha um usuario",color:"blue-grey","item-color":"blue-grey",rules:[e.rules.required],outlined:""},scopedSlots:e._u([{key:"selection",fn:function(a){return[e._v(" "+e._s(a.item.id)+" - "+e._s(a.item.nome)+" ")]}},{key:"item",fn:function(a){return[e._v(" "+e._s(a.item.id)+" - "+e._s(a.item.nome)+" ")]}}]),model:{value:e.aluguel.usuarioId,callback:function(a){e.$set(e.aluguel,"usuarioId",a)},expression:"aluguel.usuarioId"}})],1)],1),t("v-row",[t("v-col",{attrs:{cols:"12"}},[t("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(a){var l=a.on,o=a.attrs;return[t("v-text-field",e._g(e._b({attrs:{label:"Data de aluguel","append-icon":"mdi-calendar",readonly:"",outlined:"",rules:[e.rules.required],hint:"Selecione a data de aluguel",color:"blue-grey"},on:{blur:function(a){e.dateAluguel=e.parseDate(e.dateFormatted)}},model:{value:e.aluguel.dataAluguel,callback:function(a){e.$set(e.aluguel,"dataAluguel",a)},expression:"aluguel.dataAluguel"}},"v-text-field",o,!1),l))]}}]),model:{value:e.menuAluguel,callback:function(a){e.menuAluguel=a},expression:"menuAluguel"}},[t("v-date-picker",{attrs:{"no-title":"",scrollable:"",color:"blue-grey"},on:{input:function(a){e.menuAluguel=!1}},model:{value:e.dateAluguel,callback:function(a){e.dateAluguel=a},expression:"dateAluguel"}})],1)],1)],1),t("v-row",[t("v-col",{attrs:{cols:"12"}},[t("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(a){var l=a.on,o=a.attrs;return[t("v-text-field",e._g(e._b({attrs:{label:"Data de previsão","append-icon":"mdi-calendar",readonly:"",outlined:"",rules:[e.rules.required],hint:"Selecione a data de previsão",color:"blue-grey"},on:{blur:function(a){e.datePrevisao=e.parseDate(e.dateFormatted)}},model:{value:e.aluguel.dataPrevisao,callback:function(a){e.$set(e.aluguel,"dataPrevisao",a)},expression:"aluguel.dataPrevisao"}},"v-text-field",o,!1),l))]}}]),model:{value:e.menuPrevisao,callback:function(a){e.menuPrevisao=a},expression:"menuPrevisao"}},[t("v-date-picker",{attrs:{"no-title":"",scrollable:"",min:e.dateAluguel,color:"blue-grey"},on:{input:function(a){e.menuPrevisao=!1}},model:{value:e.datePrevisao,callback:function(a){e.datePrevisao=a},expression:"datePrevisao"}})],1)],1)],1),t("v-row",[t("v-col",{attrs:{cols:"12"}},[t("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(a){var l=a.on,o=a.attrs;return[t("v-text-field",e._g(e._b({attrs:{label:"Data de devolução","append-icon":"mdi-calendar",readonly:"",outlined:"",hint:"Selecione a data de devolução",color:"blue-grey"},on:{blur:function(a){e.dateDevolucao=e.parseDate(e.dateFormatted)}},model:{value:e.aluguel.dataDevolucao,callback:function(a){e.$set(e.aluguel,"dataDevolucao",a)},expression:"aluguel.dataDevolucao"}},"v-text-field",o,!1),l))]}}]),model:{value:e.menuDevolucao,callback:function(a){e.menuDevolucao=a},expression:"menuDevolucao"}},[t("v-date-picker",{attrs:{"no-title":"",min:e.dateAluguel,scrollable:"",color:"blue-grey"},on:{input:function(a){e.menuDevolucao=!1}},model:{value:e.dateDevolucao,callback:function(a){e.dateDevolucao=a},expression:"dateDevolucao"}})],1)],1)],1)],1)],1)],1),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{color:"red darken-1",text:""},on:{click:e.close}},[e._v(" Cancelar ")]),t("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:e.save}},[e._v(" Salvar ")])],1)],1)],1)],1)]},proxy:!0},{key:"item.status",fn:function(a){var l=a.item;return[t("v-chip",{attrs:{color:e.getColor(l.status),dark:""}},[e._v(" "+e._s(l.status)+" ")])]}},{key:"item.actions",fn:function(a){var l=a.item;return[t("v-icon",{staticClass:"mr-2",attrs:{size:"20"},on:{click:function(a){return e.editItem(l)}}},[e._v(" mdi-pencil ")]),t("v-icon",{directives:[{name:"show",rawName:"v-show",value:!l.dataDevolucao,expression:"!item.dataDevolucao"}],staticClass:"mr-2",attrs:{size:"20"},on:{click:function(a){return e.returnBook(l)}}},[e._v(" mdi-book-check-outline ")])]}},{key:"no-data",fn:function(){return[t("v-btn",{attrs:{color:"primary"},on:{click:e.initialize}},[e._v(" Reset ")])]},proxy:!0}],null,!0)})],1),t("v-divider"),t("v-card",{attrs:{rounded:"0",color:"blue-grey darken-3 rounded-b"}},[t("v-col",{attrs:{cols:"12"}},[t("v-row",[t("v-col",{attrs:{cols:"4",sm:"4"}},[t("v-select",{attrs:{items:e.pageSizes,label:"Items por Pagina",outlined:"","item-color":"blue-grey",color:"white",dark:""},on:{change:e.handlePageSizeChange},model:{value:e.pageSize,callback:function(a){e.pageSize=a},expression:"pageSize"}})],1),t("v-col",{attrs:{cols:"12",sm:"8"}},[t("v-pagination",{attrs:{length:e.totalPages,"total-visible":"7","next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left",color:"blue-grey"},on:{input:e.handlePageChange},model:{value:e.page,callback:function(a){e.page=a},expression:"page"}})],1)],1)],1)],1)],1)},o=[],i=t("65c5"),u=t("086f"),s=t("9249"),r=t("c1df"),n=t.n(r),d={name:"App",data:()=>({dialog:!1,dialogDelete:!1,loading:!0,menuAluguel:!1,menuPrevisao:!1,menuDevolucao:!1,search:"",alugueis:[],livros:[],usuarios:[],dateAluguel:"",datePrevisao:"",dateDevolucao:"",dateFormatted:"",totalAlugueis:0,page:1,totalPages:0,pageSize:5,pageSizes:[5,10,15],aluguel:{id:null,usuarioId:null,usuario:{},livroId:null,livro:{},dataAluguel:"",dataPrevisao:"",dataDevolucao:""},headers:[{text:"ID",align:"start",sortable:!0,value:"id"},{text:"Livro",value:"livro.nome"},{text:"Usuário",value:"usuario.nome"},{text:"Aluguel",value:"dataAluguel"},{text:"Previsão",value:"dataPrevisao"},{text:"Devolução",value:"dataDevolucao"},{text:"Status",value:"status"},{text:"Ações",value:"actions",sortable:!1}],rules:{required:e=>!!e||"Campo obrigatório",quantityLivro:e=>0!=e.quantidade||"Livro faltando"}}),computed:{formTitle(){return this.aluguel.id?"Editar Aluguel":"Novo Aluguel"}},watch:{dialog(e){e||this.close()},dialogDelete(e){e||this.closeDelete()},dateAluguel(e){this.aluguel.dataAluguel=this.formatDate(this.dateAluguel)},datePrevisao(e){this.aluguel.dataPrevisao=this.formatDate(this.datePrevisao)},dateDevolucao(e){this.aluguel.dataDevolucao=this.formatDate(this.dateDevolucao)}},created(){this.initialize()},methods:{initialize(){const e=this.getRequestParams(this.page,this.pageSize);this.loading=!0,i["a"].findAll(e).then(e=>{const{totalElements:a,totalPages:t,content:l}=e.data;this.alugueis=l.map(e=>(Object.defineProperty(e,"status",{value:this.getStatus(e)}),e)),this.totalAlugueis=a,this.totalPages=t,this.loading=!1}),this.findAllUsuarios(),this.findAllLivros()},getRequestParams(e,a){let t={};return e&&(t["page"]=e-1),a&&(t["size"]=a),t},handlePageChange(e){this.page=e,this.initialize()},handlePageSizeChange(e){this.pageSize=e,this.page=1,this.initialize()},editItem(e){this.aluguel.id=e.id,this.aluguel.usuarioId=e.usuario.id,this.aluguel.usuario=e.usuario,this.aluguel.livroId=e.livro.id,this.aluguel.livro=e.livro,this.aluguel.dataAluguel=e.dataAluguel,this.aluguel.dataPrevisao=e.dataPrevisao,this.aluguel.dataDevolucao=e.dataDevolucao,this.dialog=!0},returnBook(e){this.aluguel.id=e.id,this.aluguel.usuarioId=e.usuario.id,this.aluguel.usuario=e.usuario,this.aluguel.livroId=e.livro.id,this.aluguel.livro=e.livro,this.aluguel.dataAluguel=e.dataAluguel,this.aluguel.dataPrevisao=e.dataPrevisao,this.aluguel.dataDevolucao=n()((new Date).toISOString().slice(0,10)).format("DD-MM-YYYY"),i["a"].update(this.aluguel).then(()=>{this.aluguel={},this.initialize(),Toast.fire("Livro devolvido com sucesso","","success")})},close(){this.dialog=!1,this.$refs.form.resetValidation(),this.dialog||(this.dateAluguel="",this.aluguel={})},closeDelete(){this.dialogDelete=!1},save(){this.$refs.form.validate()&&(n()(this.aluguel.dataPrevisao,"DD-MM-YYYY").isBefore(n()(this.aluguel.dataAluguel,"DD-MM-YYYY"))||n()(this.aluguel.dataDevolucao,"DD-MM-YYYY").isBefore(n()(this.aluguel.dataAluguel,"DD-MM-YYYY"))?(this.close(),Toast.fire("Data de aluguel não pode ser maior que às demais","","error")):this.aluguel.id?i["a"].update(this.aluguel).then(()=>{Toast.fire("Aluguel alterado com sucesso","","success"),this.aluguel={},this.initialize()}).catch(()=>{this.close(),Toast.fire("Livro selecionado, com 0 quantidade no estoque","","error")}):i["a"].save(this.aluguel).then(()=>{Toast.fire("Aluguel cadastrado com sucesso","","success"),this.aluguel={},this.initialize()}).catch(()=>{this.close(),Toast.fire("Livro selecionado, com 0 quantidade no estoque","","error")}),this.aluguel={},this.close())},findAllLivros(){s["a"].findAllNotPaged().then(e=>{this.livros=e.data})},findAllUsuarios(){u["a"].findAllNotPaged().then(e=>{this.usuarios=e.data})},formatDate(e){if(!e)return null;const[a,t,l]=e.split("-");return`${l}-${t}-${a}`},getStatus(e){return n()(e.dataPrevisao,"DD-MM-YYYY").isBefore(n()(e.dataDevolucao,"DD-MM-YYYY"))?"Atrasado":n()(e.dataPrevisao,"DD-MM-YYYY").isSameOrAfter(n()(e.dataDevolucao,"DD-MM-YYYY"))?"No prazo":e.dataPrevisao?"Pendente":void console.log(dataPrevisao)},getColor(e){return"No prazo"==e?"green":"Pendente"==e?"orange":"red"},parseDate(e){if(!e)return null;const[a,t,l]=e.split("/");return`${l}-${a.padStart(2,"0")}-${t.padStart(2,"0")}`}}},c=d,v=t("2877"),g=t("6544"),h=t.n(g),m=t("8336"),f=t("b0af"),p=t("99d9"),b=t("cc20"),D=t("62ad"),k=t("a523"),x=t("8fea"),A=t("2e4b"),P=t("169a"),y=t("ce7e"),_=t("4bd4"),Y=t("132d"),S=t("e449"),w=t("891e"),C=t("0fd9"),z=t("b974"),V=t("2fa4"),M=t("8654"),I=t("71d9"),q=t("2a7f"),T=Object(v["a"])(c,l,o,!1,null,null,null);a["default"]=T.exports;h()(T,{VBtn:m["a"],VCard:f["a"],VCardActions:p["a"],VCardText:p["b"],VCardTitle:p["c"],VChip:b["a"],VCol:D["a"],VContainer:k["a"],VDataTable:x["a"],VDatePicker:A["a"],VDialog:P["a"],VDivider:y["a"],VForm:_["a"],VIcon:Y["a"],VMenu:S["a"],VPagination:w["a"],VRow:C["a"],VSelect:z["a"],VSpacer:V["a"],VTextField:M["a"],VToolbar:I["a"],VToolbarTitle:q["a"]})}}]);
//# sourceMappingURL=chunk-2d226909.7dd2dd7a.js.map